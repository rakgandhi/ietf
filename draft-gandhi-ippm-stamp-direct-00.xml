<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC0768 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0768.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8762 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8762.xml">
<!ENTITY RFC8972 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8972.xml">
<!ENTITY RFC2104 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2104.xml">
<!ENTITY RFC2113 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2113.xml">
<!ENTITY RFC2680 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2680.xml">
<!ENTITY RFC4868 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4868.xml">
<!ENTITY RFC5884 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5884.xml">
<!ENTITY RFC6335 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6335.xml">
<!ENTITY RFC6437 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6437.xml">
<!ENTITY RFC6936 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6936.xml">
<!ENTITY RFC7820 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7820.xml">
<!ENTITY RFC8029 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8029.xml">
<!ENTITY RFC8085 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8085.xml">
<!ENTITY RFC8186 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8186.xml">
<!ENTITY RFC8321 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8321.xml">
<!ENTITY RFC8402 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8402.xml">
<!ENTITY RFC8754 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8754.xml">
<!ENTITY I-D.gandhi-ippm-stamp-srpm SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.gandhi-ippm-stamp-srpm.xml">
<!ENTITY I-D.ietf-pce-sr-bidir-path SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-pce-sr-bidir-path.xml">
]>
<rfc submissionType="IETF" docName="draft-gandhi-ippm-stamp-direct-00" category="std" ipr="trust200902">
    <!-- Generated by id2xml 1.5.0 on 2020-02-06T01:41:26Z -->
    <?rfc compact="yes"?>
    <?rfc text-list-symbols="oo*+-"?>
    <?rfc subcompact="no"?>
    <?rfc sortrefs="no"?>
    <?rfc symrefs="yes"?>
    <?rfc strict="yes"?>
    <?rfc toc="yes"?>
    <front>
    <title abbrev="STAMP Extensions for Direct Measurement">Simple TWAMP (STAMP) Extensions for Direct Measurement</title>
    <author fullname="Rakesh Gandhi" initials="R." role="editor" surname="Gandhi">
    <organization>Cisco Systems, Inc.</organization>
    <address><postal><street>Canada</street>
    </postal>
        <email>rgandhi@cisco.com</email>
    </address>
    </author>

    <author fullname="Clarence Filsfils" initials="C." surname="Filsfils">
    <organization>Cisco Systems, Inc.</organization>
        <address>
        <email>cfilsfil@cisco.com</email>
    </address>
    </author>

    <author fullname="Daniel Voyer" initials="D." surname="Voyer">
    <organization>Bell Canada</organization>
        <address>
        <email>daniel.voyer@bell.ca</email>
    </address>
    </author>

    <author fullname="Mach(Guoyi) Chen" initials="M." surname="Chen">
    <organization>Huawei</organization>
        <address>
        <email>mach.chen@huawei.com</email>
    </address>
    </author>

    <author fullname="Bart Janssens" initials="B." surname="Janssens">
    <organization>Colt</organization>
        <address>
    <email>Bart.Janssens@colt.net</email>
    </address>
    </author>

    <date day="30" month="January" year="2021"/>
    <workgroup>IPPM Working Group</workgroup>
    <abstract><t>
   This document specifies RFC 8762 
   (Simple Two-Way Active Measurement Protocol (STAMP))
   extensions for Direct Measurement for detecting accurate data 
   packet loss in a network those are efficient for hardware-based implementation.</t>

    </abstract>
    </front>

    <middle>
    <section title="Introduction" anchor="sect-1"><t>
   The Simple Two-way Active Measurement Protocol (STAMP) <xref target="RFC8762"/> provides
   capabilities for the measurement of various performance
   metrics in IP networks using test packets. 
   It eliminates the need for control protocol by using
   configuration data model to provision test sessions. 
   <xref target="RFC8972"/> defines optional extensions for STAMP.</t>

   <t>Many Service Provider Service Level Agreements (SLAs) depend on the 
   ability to measure performance loss metric experienced by Customer data traffic. 
   Currently there is no efficient active measurement protocol 
   available for accurate data packet loss measurement in IP networks.
   Note that an approach for conducting packet loss measurement in IP
   networks is documented in <xref target="RFC2680"/>.
   This approach requires clock synchronization
   between the measurement points and lacks support for Direct Measurement.
   The STAMP can be used for test packet 
   loss detection (i.e. synthetic packet loss measurement), however, that 
   does not provide accurate Customer data packet loss metrics.</t>

   <t>The STAMP test packet with a "Direct Measurement" TLV (Type 5) <xref target="RFC8972"/>
   can be used for combined delay and data packet loss
   measurement, which is suitable for control-plane based counter collection. 
   This method however has following limitations:</t>
       
    <t><list style="symbols"><t>
     For only Direct Measurement, STAMP test packet requires the hardware to 
     support the STAMP test packets and support timestamps, in addition to counters.
     One-way delay also requires clock synchronization.</t> 
       
    <t>The location of the transmit counter is not at the fixed location in STAMP test packets. 
     Also, the location of the transmit counter on the STAMP Session-Reflector 
     test packet is not at the same location as the STAMP Session-Sender test packet. 
     This makes in-band counter-stamping the STAMP test packets difficult to implement
     in hardware.</t>

    <t>
     Furthermore, for hardware-based counter collection for loss detection, 
     the optional "Direct Measurement" TLV adds unnecessary processing overhead 
     on the Session-Reflector as not all STAMP test
     packets carry the "Direct Measurement" TLV.</t>
                
    <t>
     In addition, STAMP test packet does not support 64-bit counters.</t> 
                
    <t>
     The STAMP test packet does not support counters for bytes.</t> 
                
    <t>
     The STAMP test packet does not support counters per traffic class.</t>

    <t>
     The STAMP test packet also does not identify the block number of the Direct Measurement, which is  
     required for Alternate-Marking Method <xref target="RFC8321"/> for loss measurement.
     This is needed in case of out-of-order data packets.</t>

   </list>
   </t>

   <t>This document specifies STAMP 
   extensions for Direct Measurement for detecting accurate data packet loss in a network those 
   are efficient for hardware-based implementation.
   </t>

    </section>

    <section title="Conventions Used in This Document" anchor="sect-2">
    <section title="Requirements Language" anchor="sect-2.1"><t>
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <xref target="RFC2119"/> <xref target="RFC8174"/>
   when, and only when, they appear in all capitals, as shown here.</t>

    </section>

    <section title="Abbreviations" anchor="sect-2.2"><t>
   DM: Direct Measurement.</t>

    <t>
   HMAC: Hashed Message Authentication Code.</t>

    <t>
   LM: Loss Measurement.</t>

    <t>
   PM: Performance Measurement.</t>

    <t>
   SHA: Secure Hash Algorithm.</t>

    <t>
   DSID: Session Identifier.</t>

    <t>
   STAMP: Simple Two-way Active Measurement Protocol.</t>

    </section>

    <section title="Reference Topology" anchor="sect-2.3"><t>
   As shown in the DM reference topology blow, the Session-Sender R1 
   transmits Direct Measurement (DM) test packets over UDP transport
   toward the Session-Reflector R3.  The Session-Reflector R3
   receives the Session-Sender's DM test packet and acts according to the
   local configuration. The Session-Reflector R3 sends 
   DM reply test packet to the Session-Sender R1.</t> 

    <figure><artwork><![CDATA[
                     C1                  C2
                    /                     \
           +-------+    DM Test Packet     +-------+
           |       | - - - - - - - - - - ->|       |
           |   R1  |=======================|   R3  |
           |       |<- - - - - - - - - - - |       |
           +-------+  DM Reply Test Packet +-------+
                    \                     /
                     C4                  C3

         Session-Sender                Session-Reflector

                    DM Reference Topology
]]></artwork>
    </figure>

    </section>
  </section>

    <section title="Overview" anchor="sect-3"><t>
    For accurate data packet loss detection, using the extensions defined in this
    document, the DM test packets are sent in-band (on the
    same path as the data traffic flow) by the Session-Sender, and are used
    to collect the transmit and receive counters for the data traffic flow under measurement.</t>

    <t>The DM test packets carry user-configured destination UDP port. 
    The destination UDP port 862 is not used for the DM test packets 
    defined in this document. The user-configured
    destination UDP port follows the guidelines described in <xref target="RFC8762"/>. 
    Different destination UDP port is used for
    DM test packets than the STAMP test packets defined in <xref target="RFC8762"/>.
    Hence, the Session-Sender and the Session-Reflector do not require backwards
    compatibility and support for the existing STAMP test packets defined in
    <xref target="RFC8762"/>.</t>
  
    </section>


    <section title="Session-Sender Direct Measurement Test Packet" anchor="sect-4">
   <t>In this document, Session-Sender DM test packet formats 
   are defined as shown in Figure 1 and Figure 2. 
   They are stand-alone DM test packet formats to 
   carry transmit and receive counters for the data traffic 
   flow under measurement. The DM test packet formats are similar to the STAMP test 
   packet formats (for example location of the Counters and Timestamps).</t>

    <figure title="Session-Sender Direct Measurement Test Packet - Unauthenticated Mode" anchor="ure-lm-test-packet-format"><artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Transmit Counter (C1)                  |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |X|B|T| DSCP      | Block Number| DSID                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         MBZ                                   | Control Code  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        MBZ (24 octets)                        |
 |                                                               |
 |                                                               |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
    </figure>

    <figure title="Session-Sender Direct Measurement Test Packet - Authenticated Mode" anchor="ure-lm-test-packet-format-authenticated-mode"><artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (12 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Transmit Counter (C1)                  |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |X|B|T| DSCP      | Block Number| DSID                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         MBZ                                   | Control Code  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (64 octets)                        |
 .                                                               .
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        HMAC (16 octets)                       |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
    </figure>

    <t>
   Sequence Number (32-bit): As defined in <xref target="RFC8762"/>.</t>

    <t>
   Transmit Counter (64-bit): The number of packets or octets sent by
   the Session-Sender in the 
   DM test packet.  The counter is always written at the well-known fixed 
   location in the DM test packet.  This is an important
   property for hardware-based implementation. Counter is for the data traffic flow
   under measurement.</t>

   <t><list style="hanging" hangIndent="3"><t hangText="XBT Flags: The meanings of the Flag bits are:">
    <vspace blankLines="1"/>
    X: Extended counter format indicator.  Indicates the use of
      extended (64-bit) counter values.  Initialized to 1 upon creation
      (and prior to transmission) of a DM test packet and copied from test packet
      to reply test packet.  Set to 0 when the DM test packet is
      transmitted or received over an interface that writes 32-bit
      counter values.
    <vspace blankLines="1"/>
    B: Octet (byte) count.  When set to 1, indicates that the Counter
      fields represent octet counts.  The octet count applies to all
      packets within the Direct Measurement scope, and the octet count of a packet sent
      or received includes the total length of that packet (but excludes
      headers, labels, or framing of the channel itself).  When set to
      0, indicates that the Counter fields represent packet counts.
    <vspace blankLines="1"/>
      T: Traffic-class-specific measurement indicator.  Set to 1 when
      the Direct Measurement operation is scoped to data packets of a particular
      traffic class (DSCP value), and 0 otherwise.  When set to 1, the
      DSCP field of the DM test packet indicates the measured traffic class.
    </t>

    </list>
   </t>

    <t>
   DSCP (6-bit): DSCP of the data traffic flow being measured when T flag is set.</t>

    <t>
   Block Number (7-bit): The Direct Measurement using Alternate-Marking
   method defined in <xref target="RFC8321"/> requires to 
   collect Block Number for the data traffic flow.  To
   be able to correlate the transmit and receive counters of the
   matching block number, the block number of the counters
   is carried by the DM test packet and reply test packet.</t>

    <t>
   DSID (16-bit): Session Identifier. Follow the procedure as SSID 
    as defined in <xref target="RFC8972"/>.</t>

   <t>
   Control Code Field (8-bit): Flags set as follows in Session-Sender DM test packet.</t>
   <t>  </t>

    <t><list hangIndent="4" style="hanging"><t>
       0x0: The existing default behaviour as defined in <xref target="RFC8762"/>.</t>
    </list>
    </t>

    <t><list hangIndent="4" style="hanging"><t>
       0x1: In-band Reply Requested.  Indicates that this DM test packet has
       been sent over a bidirectional channel and the reply is requested
       in-band over the same incoming link in the reverse direction.</t> 
    </list>
    </t>

    <t><list hangIndent="4" style="hanging"><t>
       0x2: No Reply Requested.</t>
    </list>
    </t>

    <t>
   The detailed use of the HMAC field is described in Section 4.4 of <xref target="RFC8762"/>.</t>

    <t>
   HMAC uses its own key and the mechanism to distribute the HMAC key is
   outside the scope of this document.</t>

    <t>
   MBZ: As defined in <xref target="RFC8762"/>.</t>

    </section>

    <section title="Session-Reflector Direct Measurement Test Packet" anchor="sect-5">
        <t>In this document, Session-Reflector DM test packet formats 
         are defined as shown in Figure 3 and Figure 4.</t>

    <figure title="Session-Reflector Direct Measurement Test Packet - Unauthenticated Mode" anchor="ure-lm-reply-packet-format"><artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Transmit Counter (C3)                  |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |X|B|T| DSCP      | Block Number| DSID                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Receive Counter (C2)                   |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sender Sequence Number                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sender Counter (C1)                    |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (4 octets)                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |Ses-Sender TTL |        MBZ                                    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
    </figure>

    <figure title="Session-Reflector Direct Measurement Test Packet - Authenticated Mode" anchor="ure-lm--reply-packet-format-authenticated-mode"><artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (12 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Transmit Counter (C3)                  |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |X|B|T| DSCP      | Block Number| DSID                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (4 octets)                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Receive Counter (C2)                   |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (8 octets)                         |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sender Sequence Number                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (12 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sender Counter (C1)                    |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (4 octets)                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        MBZ (4 octets)                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |Ses-Sender TTL |                                               |
 +-+-+-+-+-+-+-+-+                                               |
 |                        MBZ (15 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        HMAC (16 octets)                       |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
    </figure>

    <t>
   Sequence Number (32-bit): As defined in <xref target="RFC8762"/>.</t>

   <t>
   Transmit Counter (64-bit): The number of packets or octets sent by
   the Session-Reflector in the DM reply test packet. 
   Counter is for the data traffic flow under measurement.
   The Session-Reflector writes the transmit counter at the same location in the
   DM reply test packet as the Session-Sender DM test packet. 
   This is an important property for hardware-based implementation. 
   </t>

    <t>
   Receive Counter (64-bit): The number of packets or octets received at
   the Session-Reflector.  It is written by the Session-Reflector in the DM reply test packet.
   Counter is for the data traffic flow under measurement.</t>

    <t>
   Sender Counter (64-bit): This is the exact copy of the transmit
   counter from the received Session-Sender DM test packet.  It is written by the
   Session-Reflector in the DM test packet.</t>

    <t>
   Sender Sequence Number (32-bit): As defined in <xref target="RFC8762"/>.</t>

    <t>
   Session-Sender TTL: As defined in <xref target="RFC8762"/>.</t>

    <t>
   The detailed use of the HMAC field is described in Section 4.4 of <xref target="RFC8762"/>.</t>

    <t>
   MBZ: As defined in <xref target="RFC8762"/>.</t>

        </section>

    <section title="Data Loss Calculation" anchor="sect-6"><t>
   Using the Counters C1, C2, C3 and C4 as per reference topology, 
   from the nth and (n-1)th DM test packets.</t>

   <t>
    Transmit Loss TxL[n-1, n] = (C1[n] – C1[n-1]) - (C2[n] - C2[n-1])
   </t>

   <t>
    Receive Loss RxL[n-1, n]  = (C3[n] – C3[n-1]) - (C4[n] – C4[n-1])
   </t>

   <t>
    The total transmit and receive loss is calculated as follows:
   </t>

   <t>
    Total Transmit Loss = TxL[1,2] + TxL[2,3] + ...
   </t>

   <t>
    Total Receive Loss  = RxL[1,2] + RxL[2,3] + ...
   </t>

   <t>These values are updated each time a DM reply test packet is received and
   processed at the Session-Sender, and they represent the total transmit and receive loss
   since the Direct Measurement operation was initiated. 
   When computing the values TxL[n-1,n] and RxL[n-1,n], the possibility 
   of counter wrap must be taken into account. 
   </t>

        </section>

    <section title="Integrity Protection and Confidentiality Protection" anchor="sect-7"><t>
   As specified in <xref target="RFC8762"/>.</t> 
        </section>

    <section title="Security Considerations" anchor="sect-8"><t>
   The performance measurement is intended for deployment in
   well-managed private and service provider networks.  As such, it
   assumes that a node involved in a measurement operation has
   previously verified the integrity of the path and the identity of the
   Session-Reflector.</t>

    <t>If desired, attacks can be mitigated by performing basic validation
   and sanity checks, at the Session-Sender, of the counter fields
   in received DM reply test packets.  The minimal state
   associated with these protocols also limits the extent of measurement
   disruption that can be caused by a corrupt or invalid packet to a
   single test cycle.</t>

    <t>Use of HMAC-SHA-256 in the authenticated mode protects the data
   integrity of the test packets. Cryptographic measures may 
   be enhanced by the correct configuration
   of access-control lists and firewalls.</t>

   <t>The security considerations specified in <xref target="RFC8762"/>
   and <xref target="RFC8972"/> also apply to the extensions
   defined in this document.</t> 

    </section>


    </middle>

    <back>
    <references title="Normative References">
    &RFC2119;
    &RFC8174;
    &RFC8762;
    &RFC8972;
    </references>
    <references title="Informative References">
    &RFC2680;
    &RFC8321;
    </references>
    <section title="Acknowledgments" numbered="no" anchor="acknowledgments"><t>
   The authors would like to thank Greg Mirsky, Tianran Zhou, Gyan Mishra, 
   Zhenqiang Li, Reshad Rahman, Cheng Li, 
   and Yali Wang for the comments on Direct Measurement. 
   The authors would like to acknowledge the earlier 
   work on the loss measurement using TWAMP
   described in draft-xiao-ippm-twamp-ext-direct-loss.</t>

    </section>

    </back>

    </rfc>
