



SPRING Working Group                                      R. Gandhi, Ed.
Internet-Draft                                               C. Filsfils
Intended status: Standards Track                     Cisco Systems, Inc.
Expires: August 9, 2020                                   D. Voyer (TBD)
                                                             Bell Canada
                                                              M. C (TBD)
                                                                       H
                                                       B. Janssens (TBD)
                                                                    Colt
                                                        February 6, 2020


Enhanced Performance and Liveness Monitoring in Segment Routing Networks
                 draft-gandhi-spring-sr-enhanced-plm-00

Abstract

   Segment Routing (SR) leverages the source routing paradigm.  SR is
   applicable to both Multiprotocol Label Switching (SR-MPLS) and IPv6
   (SRv6) data planes.  This document defines procedure for Enhanced
   Performance and Liveness Monitoring (PLM) in Segment Routing
   networks.  The procedure uses the probe messages defined in RFC 5357
   (Two-Way Active Measurement Protocol (TWAMP) Light).  The procedure
   specified is applicable to both SR-MPLS and SRv6 data planes.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 9, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.





Gandhi, et al.           Expires August 9, 2020                 [Page 1]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   3
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
     2.2.  Abbreviations . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Liveness Monitoring . . . . . . . . . . . . . . . . . . . . .   4
     3.1.  Loopback Mode for SR-MPLS . . . . . . . . . . . . . . . .   4
     3.2.  Loopback Mode for SRv6  . . . . . . . . . . . . . . . . .   5
   4.  Enhanced Performance and Liveness Monitoring  . . . . . . . .   6
     4.1.  Loopback Mode with Network Programming for SR-MPLS  . . .   7
     4.2.  Loopback Mode with Network Programming for SRv6 . . . . .   7
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   9
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  11
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   Segment Routing (SR) leverages the source routing paradigm and
   greatly simplifies network operations for Software Defined Networks
   (SDNs).  SR is applicable to both Multiprotocol Label Switching (SR-
   MPLS) and IPv6 (SRv6) data planes.  SR takes advantage of the Equal-
   Cost Multipaths (ECMPs) between source and transit nodes, between
   transit nodes and between transit and destination nodes.  SR Policies
   as defined in [I-D.ietf-spring-segment-routing-policy]are used to
   steer traffic through a specific, user-defined paths using a stack of
   Segments.  Built-in Liveness Monitoring for detecting faults as well
   as Performance Delay and Loss Monitoring are essential requirements
   to provide Service Level Agreements (SLAs) in SR networks.

   The One-Way Active Measurement Protocol (OWAMP) defined in
   [RFC4656]and Two-Way Active Measurement Protocol (TWAMP) defined in
   [RFC5357]provide capabilities for the measurement of various
   performance metrics in IP networks using probe messages.  The TWAMP



Gandhi, et al.           Expires August 9, 2020                 [Page 2]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   Light [Appendix I in RFC 5357] provides simplified mechanisms for
   active performance measurement in Customer IP networks by
   provisioning UDP paths that eliminates the control-channel signaling.

   This document defines procedure for Enhanced Performance and Liveness
   Monitoring (PLM) in Segment Routing networks.  The procedure uses the
   probe messages defined in [RFC5357](Two-Way Active Measurement
   Protocol (TWAMP) Light) in loopback mode.  The procedure specified is
   applicable to both SR-MPLS and SRv6 data planes.

2.  Conventions Used in This Document

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119] [RFC8174]
   when, and only when, they appear in all capitals, as shown here.

2.2.  Abbreviations

   BSID: Binding Segment ID.

   DM: Delay Measurement.

   ECMP: Equal Cost Multi-Path.

   LM: Loss Measurement.

   MPLS: Multiprotocol Label Switching.

   NTP: Network Time Protocol.

   OWAMP: One-Way Active Measurement Protocol.

   PM: Performance Measurement.

   PTP: Precision Time Protocol.

   SID: Segment ID.

   SL: Segment List.

   SR: Segment Routing.

   SRH: Segment Routing Header.

   SR-MPLS: Segment Routing with MPLS data plane.



Gandhi, et al.           Expires August 9, 2020                 [Page 3]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   SRv6: Segment Routing with IPv6 data plane.

   TC: Traffic Class.

   TWAMP: Two-Way Active Measurement Protocol.

3.  Liveness Monitoring

   For liveness monitoring for an SR Policy, the loopback mode as
   defined in [I-D.gandhi-spring-twamp-srpm] is used.  The TWAMP probe
   messages for delay measurement defined in [RFC5357] are sent by the
   head-end sender node to the endpoint node of the SR Policy using the
   Segment Lists of the SR Policy.  The Source and destination IP
   addresses in the probe packets are set to the endpoint node and the
   sender node.  The probe packets are received back by the sender node
   via IP return path.  The Segment List of the return path can be added
   in the probe message header to receive the probe message on a
   specific SR path.

   Liveness failure is notified when N number of consecutive probe
   messages are not received back at the sender, where N is locally
   provisioned.

                  +-------+       Probe         +-------+
                  |       | - - - - - - - - - - |       |
                  |   R1  |--------------------||  R5   |
                  |       |<- - - - - - - - - - |       |
                  +-------+     Return Probe    +-------+
                   Sender                       Endpoint
                                                (Forword)

                          Figure 1: Loopback Mode

3.1.  Loopback Mode for SR-MPLS

   Lopback Mode for SR-MPLS TBD















Gandhi, et al.           Expires August 9, 2020                 [Page 4]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Segment(1)             | TC  |S|      TTL      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Segment(n)             | TC  |S|      TTL      |
     +---------------------------------------------------------------+
     | IP Header                                                     |
     .  Source IP Address = Endpoint IPv4 or IPv6 Address            .
     .  Destination IP Address = Sender IPv4 or IPv6 Address         .
     .  Protocol = UDP                                               .
     .                                                               .
     +---------------------------------------------------------------+
     | UDP Header                                                    |
     .  Source Port = As chosen by Sender                            .
     .  Destination Port = User-configured Port                      .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   RFC 5357 Message in Payload                                 |
     .                                                               .
     +---------------------------------------------------------------+

                Figure 2: Probe Message Header For SR-MPLS

3.2.  Loopback Mode for SRv6

   Lopback Mode for SRv6 TBD




















Gandhi, et al.           Expires August 9, 2020                 [Page 5]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


     +---------------------------------------------------------------+
     |                           SRH                                 |
     .                           <Segment List>                      .
     .                                                               .
     +---------------------------------------------------------------+
     | IP Header                                                     |
     .  Source IP Address = Endpoint IPv6 Address                    .
     .  Destination IP Address = Sender IPv6 Address                 .
     .  Protocol = UDP                                               .
     .                                                               .
     +---------------------------------------------------------------+
     | UDP Header                                                    |
     .  Source Port = As chosen by Sender                            .
     .  Destination Port = User-configured Port                      .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   RFC 5357 Message in Payload                                 |
     .                                                               .
     +---------------------------------------------------------------+

                  Figure 3: Probe Message Header for SRv6

4.  Enhanced Performance and Liveness Monitoring

   The enhanced performance and liveness monitoring for an SR Policy is
   defined using loopback mode with network programming.  In this mode,
   both transmit and receive timestamps are collected in data plane by
   the probe messages sent in loopback mode enabled with network
   programming function.  The endpoint node returns the receive
   timestamp in the payload of the TWAMP probe message without punting
   the probe message in control-plane.  The end-to-end delay is measured
   using the receive and transmit timestamps in the probe message.
   Liveness failure is notified when N number of consecutive probe
   messages are not received back at the sender, where N is locally
   provisioned.

                  +-------+       Probe         +-------+
                  |       | - - - - - - - - - - |       |
                  |   R1  |--------------------||  R5   |
                  |       |<- - - - - - - - - - |       |
                  +-------+     Return Probe    +-------+
                   Sender                       Endpoint
                                                (Timestamp and Forward)

             Figure 4: Loopback Mode with Network Programming






Gandhi, et al.           Expires August 9, 2020                 [Page 6]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


4.1.  Loopback Mode with Network Programming for SR-MPLS

   In the loopback mode with network programming for SR-MPLS, a
   timestamp label (reserved label TBD1) is added in the MPLS header to
   collect receive timestamp in the payload of the TWAMP [RFC5357]probe
   packet at a specific location locally provisioned.  When a node
   receives a packet with timestamp label, the node pops the timestamp
   label and forwards the packet using the next label or IP header in
   the packet, in addition to adding the timestamp.

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Segment(1)             | TC  |S|      TTL      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     .                                                               .
     .                                                               .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Segment(n)             | TC  |S|      TTL      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Timestamp Label (TBA1) | TC  |S|      TTL      |
     +---------------------------------------------------------------+
     | IP Header                                                     |
     .  Source IP Address = Endpoint IPv4 or IPv6 Address            .
     .  Destination IP Address = Sender IPv4 or IPv6 Address         .
     .  Protocol = UDP                                               .
     .                                                               .
     +---------------------------------------------------------------+
     | UDP Header                                                    |
     .  Source Port = As chosen by Sender                            .
     .  Destination Port = User-configured Port                      .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   RFC 5357 Message in Payload                                 |
     .                                                               .
     +---------------------------------------------------------------+

      Figure 5: Probe Message Header For SR-MPLS with Timestamp Label

4.2.  Loopback Mode with Network Programming for SRv6

   In the loopback mode with network programming for SRv6, END.OTS
   function (OAM Timestamp, value TBD2) is added for the Endpoint SID in
   SRH [I-D.ietf-6man-segment-routing-header]to collect receive
   timestamp in the payload of the TWAMP [RFC5357]probe packet at a
   specific location locally provisioned.  When a node receives a packet




Gandhi, et al.           Expires August 9, 2020                 [Page 7]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   with END.OTS function, the node forwards the packet using the next
   SID or IP header in the packet, in addition to adding the timestamp.

     +---------------------------------------------------------------+
     |                           SRH                                 |
     .                      <Segment List>                           .
     .   END.OTS (TBA2) with Target SRv6 SID                         .
     +---------------------------------------------------------------+
     | IP Header                                                     |
     .  Source IP Address = Endpoint IPv6 Address                    .
     .  Destination IP Address = Sender IPv6 Address                 .
     .  Protocol = UDP                                               .
     .                                                               .
     +---------------------------------------------------------------+
     | UDP Header                                                    |
     .  Source Port = As chosen by Sender                            .
     .  Destination Port = User-configured Port                      .
     .                                                               .
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   RFC 5357 Message in Payload                                 |
     .                                                               .
     +---------------------------------------------------------------+

      Figure 6: Probe Message Header for SRv6 With Endpoint Function

5.  Security Considerations

   TBA

6.  IANA Considerations

   IANA maintains the "Special-Purpose Multiprotocol Label Switching
   (MPLS) Label Values" registry (see <https://www.iana.org/assignments/
   mpls-label-values/mpls-label- values.xml>).  IANA is requested to
   allocate Timestamp Label value from the "Extended Special-Purpose
   MPLS Label Values" registry:

       +-------------+-------------------------+---------------+
       | Value       | Description             | Reference     |
       +-------------+-------------------------+---------------+
       | TBA1        | Timestamp Label         | This document |
       +-------------+-------------------------+---------------+

   IANA is requested to allocate, within the "SRv6 Endpoint Behaviors
   Registry" sub-registry belonging to the top-level "Segment- routing
   with IPv6 data plane (SRv6) Parameters" registry
   [I-D.ietf-spring-srv6-network-programming], the following
   allocations.



Gandhi, et al.           Expires August 9, 2020                 [Page 8]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


        +------------+-------------------------+---------------+
        | Value      | Endpoint Behavior       | Reference     |
        +------------+-------------------------+---------------+
        | TBA2       | End.OTS (OAM Timestamp) | This document |
        +------------+-------------------------+---------------+

7.  References

7.1.  Normative References

   [RFC0768]  Postel, J., "User Datagram Protocol", STD 6, RFC 768,
              DOI 10.17487/RFC0768, August 1980,
              <https://www.rfc-editor.org/info/rfc768>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC4656]  Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M.
              Zekauskas, "A One-way Active Measurement Protocol
              (OWAMP)", RFC 4656, DOI 10.17487/RFC4656, September 2006,
              <https://www.rfc-editor.org/info/rfc4656>.

   [RFC5357]  Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J.
              Babiarz, "A Two-Way Active Measurement Protocol (TWAMP)",
              RFC 5357, DOI 10.17487/RFC5357, October 2008,
              <https://www.rfc-editor.org/info/rfc5357>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

7.2.  Informative References

   [IEEE1588]
              IEEE, "1588-2008 IEEE Standard for a Precision Clock
              Synchronization Protocol for Networked Measurement and
              Control Systems", March 2008.

   [RFC5884]  Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow,
              "Bidirectional Forwarding Detection (BFD) for MPLS Label
              Switched Paths (LSPs)", RFC 5884, DOI 10.17487/RFC5884,
              June 2010, <https://www.rfc-editor.org/info/rfc5884>.







Gandhi, et al.           Expires August 9, 2020                 [Page 9]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   [RFC6335]  Cotton, M., Eggert, L., Touch, J., Westerlund, M., and S.
              Cheshire, "Internet Assigned Numbers Authority (IANA)
              Procedures for the Management of the Service Name and
              Transport Protocol Port Number Registry", BCP 165,
              RFC 6335, DOI 10.17487/RFC6335, August 2011,
              <https://www.rfc-editor.org/info/rfc6335>.

   [RFC8085]  Eggert, L., Fairhurst, G., and G. Shepherd, "UDP Usage
              Guidelines", BCP 145, RFC 8085, DOI 10.17487/RFC8085,
              March 2017, <https://www.rfc-editor.org/info/rfc8085>.

   [RFC8186]  Mirsky, G. and I. Meilik, "Support of the IEEE 1588
              Timestamp Format in a Two-Way Active Measurement Protocol
              (TWAMP)", RFC 8186, DOI 10.17487/RFC8186, June 2017,
              <https://www.rfc-editor.org/info/rfc8186>.

   [RFC8402]  Filsfils, C., Ed., Previdi, S., Ed., Ginsberg, L.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing Architecture", RFC 8402, DOI 10.17487/RFC8402,
              July 2018, <https://www.rfc-editor.org/info/rfc8402>.

   [I-D.ietf-spring-segment-routing-policy]
              Filsfils, C., Sivabalan, S., Voyer, D., Bogdanov, A., and
              P. Mattes, "Segment Routing Policy Architecture", draft-
              ietf-spring-segment-routing-policy-06 (work in progress),
              December 2019.

   [I-D.ietf-6man-segment-routing-header]
              Filsfils, C., Dukes, D., Previdi, S., Leddy, J.,
              Matsushima, S., and D. Voyer, "IPv6 Segment Routing Header
              (SRH)", draft-ietf-6man-segment-routing-header-26 (work in
              progress), October 2019.

   [I-D.ietf-pce-binding-label-sid]
              Sivabalan, S., Filsfils, C., Tantsura, J., Hardwick, J.,
              Previdi, S., and C. Li, "Carrying Binding Label/Segment-ID
              in PCE-based Networks.", draft-ietf-pce-binding-label-
              sid-01 (work in progress), November 2019.

   [I-D.li-pce-sr-bidir-path]
              Li, C., Chen, M., Cheng, W., Li, Z., Dong, J., Gandhi, R.,
              and Q. Xiong, "PCEP Extensions for Associated
              Bidirectional Segment Routing (SR) Paths", draft-li-pce-
              sr-bidir-path-06 (work in progress), August 2019.







Gandhi, et al.           Expires August 9, 2020                [Page 10]

Internet-Draft  Performance and Liveness Monitoring in SR  February 2020


   [I-D.gandhi-spring-twamp-srpm]
              Gandhi, R., Filsfils, C., Voyer, D., Chen, M., and B.
              Janssens, "Performance Measurement Using TWAMP Light for
              Segment Routing Networks", draft-gandhi-spring-twamp-
              srpm-05 (work in progress), December 2019.

   [I-D.ietf-spring-srv6-network-programming]
              Filsfils, C., Camarillo, P., Leddy, J., Voyer, D.,
              Matsushima, S., and Z. Li, "SRv6 Network Programming",
              draft-ietf-spring-srv6-network-programming-08 (work in
              progress), January 2020.

Acknowledgments

   TBD

Authors' Addresses

   Rakesh Gandhi (editor)
   Cisco Systems, Inc.
   Canada

   Email: rgandhi@cisco.com


   Clarence Filsfils
   Cisco Systems, Inc.

   Email: cfilsfil@cisco.com


   Daniel Voyer
   Bell Canada

   Email: daniel.voyer@bell.ca


   MC
   H

   Email: mc@h.com


   Bart Janssens
   Colt

   Email: Bart.Janssens@colt.net




Gandhi, et al.           Expires August 9, 2020                [Page 11]
